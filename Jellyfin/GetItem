#!/usr/bin/env bash

# GetItem - Get detailed information about a specific Jellyfin item
#
# Usage: GetItem ITEM_ID [--fields FIELD1,FIELD2,...]
#
# Returns full item details as JSON

ITEM_ID="$1"
FIELDS="$2"

if [ -z "$ITEM_ID" ]; then
    echo "Usage: $0 ITEM_ID [--fields FIELD1,FIELD2,...]" >&2
    exit 1
fi

# Remove --fields flag if present
if [ "$FIELDS" = "--fields" ]; then
    FIELDS="$3"
fi

# Build URL - use Users endpoint for full item details
URL="http://$JELLYFIN_HOST:$JELLYFIN_PORT/Users/$JELLYFIN_USERID/Items/$ITEM_ID"
if [ -n "$FIELDS" ]; then
    URL="${URL}?Fields=$FIELDS"
fi

# Make request
curl -s -H "Authorization: MediaBrowser Token=\"$JELLYFIN_API_KEY\"" "$URL" | jq '.'
