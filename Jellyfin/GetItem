#!/usr/bin/env bash

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/jellyfin-utils.lib"

# GetItem - Get detailed information about a Jellyfin item
#
# Usage: GetItem ITEM_ID [--fields FIELD1,FIELD2,...]
#
# Examples:
#   GetItem "abc123def456"
#   GetItem "abc123def456" --fields Id,Name,Path,Tags

ITEM_ID="$1"
FIELDS="$2"

jellyfin_require_args 1 $# "Usage: $0 ITEM_ID [--fields FIELD1,FIELD2,...]" || exit 1

# Handle --fields flag
if [ "$FIELDS" = "--fields" ]; then
    FIELDS="$3"
fi

log_info "Retrieving item: $ITEM_ID"

ENDPOINT="/Users/$JELLYFIN_USERID/Items/$ITEM_ID"
[ -n "$FIELDS" ] && ENDPOINT="${ENDPOINT}?Fields=$FIELDS"

jellyfin_request GET "$ENDPOINT"
jellyfin_handle_response "" "true"
